{% extends 'layout.html' %}
{% block title %}Mis Exámenes{% endblock %}
{% block content %}
<div class="dashboard-header">
  <h2>
    <span class="material-symbols-rounded">quiz</span>
    Mis Exámenes
  </h2>
  <p class="welcome">Gestiona los exámenes que has creado</p>
</div>

<div class="action-bar">
  <a href="{{ url_for('main.dashboard_profesor') }}" class="btn secondary">
    <span class="material-symbols-rounded">arrow_back</span>
    Volver al Dashboard
  </a>
  <a href="{{ url_for('profesor.crear_examen') }}" class="btn btn-primary">
    <span class="material-symbols-rounded">add</span>
    Crear Nuevo Examen
  </a>
</div>

<div class="examenes-grid">
  {% for examen in examenes %}
    <div class="examen-card">
      <div class="examen-header">
        <h3>{{ examen.titulo }}</h3>
        <div>
          {% if examen.publicado %}
            <span class="badge badge-success">
              <span class="material-symbols-rounded" style="font-size:14px;">check_circle</span>
              Publicado
            </span>
          {% else %}
            <span class="badge badge-warning">
              <span class="material-symbols-rounded" style="font-size:14px;">edit</span>
              Borrador
            </span>
          {% endif %}
          <span class="badge badge-info">
            <span class="material-symbols-rounded" style="font-size:14px;">group</span>
            {{ examen.estudiantes.count() }} estudiantes
          </span>
        </div>
      </div>
      <p class="examen-descripcion">{{ examen.descripcion or 'Sin descripción' }}</p>
      <p class="examen-fecha">
        <span class="material-symbols-rounded" style="font-size:16px;vertical-align:middle;">calendar_today</span>
        Creado: {{ examen.fecha_creacion.strftime('%d/%m/%Y') }}
      </p>
      <p class="examen-fecha">
        <strong>Preguntas:</strong> {{ examen.preguntas|length }} 
        | <strong>Duración:</strong> {{ examen.duracion_minutos or 'Sin límite' }} min
      </p>
      
      <div class="examen-actions">
        <a href="{{ url_for('profesor.gestionar_preguntas', id=examen.id) }}" class="btn btn-sm btn-primary">
          <span class="material-symbols-rounded">quiz</span>
          Preguntas
        </a>
        <a href="{{ url_for('profesor.editar_examen', id=examen.id) }}" class="btn btn-sm btn-edit">
          <span class="material-symbols-rounded">edit</span>
          Editar
        </a>
        <a href="{{ url_for('profesor.asignar_examen', id=examen.id) }}" class="btn btn-sm btn-secondary">
          <span class="material-symbols-rounded">person_add</span>
          Asignar
        </a>
        <a href="{{ url_for('profesor.ver_resultados', id=examen.id) }}" class="btn btn-sm btn-results">
          <span class="material-symbols-rounded">analytics</span>
          Resultados
        </a>
        <form method="post" action="{{ url_for('profesor.duplicar_examen', id=examen.id) }}" class="inline-form">
          <button type="submit" class="btn btn-sm btn-duplicate">
            <span class="material-symbols-rounded">content_copy</span>
            Duplicar
          </button>
        </form>
        <form method="post" action="{{ url_for('profesor.eliminar_examen', id=examen.id) }}" 
              onsubmit="return confirm('¿Eliminar el examen {{ examen.titulo }}?');" class="inline-form">
          <button type="submit" class="btn btn-sm btn-danger">
            <span class="material-symbols-rounded">delete</span>
            Eliminar
          </button>
        </form>
      </div>
    </div>
  {% else %}
    <div class="empty-state">
      <span class="material-symbols-rounded" style="font-size:4rem;opacity:0.3;">quiz</span>
      <p>No has creado exámenes aún</p>
      <a href="{{ url_for('profesor.crear_examen') }}" class="btn btn-primary">
        <span class="material-symbols-rounded">add</span>
        Crear mi primer examen
      </a>
    </div>
  {% endfor %}
</div>
{% endblock %}
