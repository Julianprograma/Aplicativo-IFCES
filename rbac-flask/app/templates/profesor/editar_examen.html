{% extends 'layout.html' %}
{% block title %}Editar Examen - {{ examen.titulo }}{% endblock %}
{% block content %}
<div class="dashboard-header">
  <h2>九勇 Editar Examen</h2>
  <p class="welcome">Modifica la configuraci칩n del examen</p>
</div>

<div class="form-container">
  <form method="post" class="form-horizontal">
    <div class="form-group">
      <label for="titulo">T칤tulo del Examen *</label>
      <input type="text" name="titulo" id="titulo" required class="form-control" value="{{ examen.titulo }}">
    </div>

    <div class="form-group">
      <label for="categoria_id">Categor칤a / Materia 游닄</label>
      <select name="categoria_id" id="categoria_id" class="form-control">
        <option value="">Sin categor칤a</option>
        {% for cat in categorias %}
          <option value="{{ cat.id }}" {{ 'selected' if examen.categoria_id == cat.id }}>
            {{ cat.icono }} {{ cat.nombre }}
          </option>
        {% endfor %}
      </select>
      <small>Clasifica el examen por tema o materia</small>
    </div>

    <div class="form-group">
      <label for="descripcion">Descripci칩n</label>
      <textarea name="descripcion" id="descripcion" rows="4" class="form-control">{{ examen.descripcion or '' }}</textarea>
    </div>

    <div class="form-group">
      <label for="duracion_minutos">Duraci칩n (minutos)</label>
      <input type="number" name="duracion_minutos" id="duracion_minutos" min="1" class="form-control" value="{{ examen.duracion_minutos or 60 }}">
      <small>Tiempo m치ximo para completar el examen</small>
    </div>

    <div class="form-group">
      <label for="fecha_limite">Fecha l칤mite</label>
      <input type="datetime-local" name="fecha_limite" id="fecha_limite" class="form-control" 
             value="{{ examen.fecha_limite.strftime('%Y-%m-%dT%H:%M') if examen.fecha_limite }}">
      <small>Fecha y hora m치xima para presentar el examen</small>
    </div>

    <fieldset class="configuraciones-avanzadas">
      <legend>丘뙖잺 Configuraciones Avanzadas</legend>
      
      <div class="form-group">
        <label for="intentos_maximos">Intentos m치ximos</label>
        <input type="number" name="intentos_maximos" id="intentos_maximos" min="1" class="form-control" value="{{ examen.intentos_maximos or 1 }}">
        <small>N칰mero de veces que un estudiante puede presentar el examen</small>
      </div>

      <div class="form-group">
        <label for="calificacion_minima">Calificaci칩n m칤nima para aprobar (%)</label>
        <div class="col-md-6">
                        <label for="duracion_minutos" class="form-label">
                            <i class="bi bi-clock"></i> Duraci칩n (minutos)
                        </label>
                        <input type="number" class="form-control" id="duracion_minutos" name="duracion_minutos" value="{{ examen.duracion_minutos }}" min="10" step="5" required>
                    </div>
                    <div class="col-md-6">
                        <label for="calificacion_minima" class="form-label">
                            <i class="bi bi-check-circle"></i> Calificaci칩n M칤nima para Aprobar (%)
                        </label>
                        <input type="number" class="form-control" id="calificacion_minima" name="calificacion_minima" value="{{ examen.calificacion_minima }}" min="0" max="100" step="5" required>
                    </div>
        <small>Porcentaje m칤nimo para considerar aprobado</small>
      </div>

      <div class="form-group">
        <label class="checkbox-label">
          <input type="checkbox" name="mostrar_respuestas" {{ 'checked' if examen.mostrar_respuestas }}>
          <span>Mostrar respuestas correctas despu칠s de completar</span>
        </label>
      </div>

      <div class="form-group">
        <label class="checkbox-label">
          <input type="checkbox" name="barajar_preguntas" {{ 'checked' if examen.barajar_preguntas }}>
          <span>Barajar orden de preguntas para cada estudiante</span>
        </label>
      </div>
    </fieldset>

    <div class="form-actions">
      <a href="{{ url_for('profesor.lista_examenes') }}" class="btn btn-secondary">Cancelar</a>
      <button type="submit" class="btn btn-primary">游 Guardar Cambios</button>
    </div>
  </form>
</div>
{% endblock %}
